# 技能生命周期

## 技能类型

| 类型 | 前缀 | 来源 | 生命周期 | 更新方式 | 数量限制 |
|-----|-----|------|---------|---------|---------|
| **任务技能** | `k_` | 任务创建时生成 | 临时，任务完成后可选升级或丢弃 | 不可直接更新 | 每任务 2-3 个 |
| **验证技能** | `p_` | k_ 技能升级 | 永久，可被后续任务复用 | 自动（usage_count） | **10 个** |
| **用户技能** | `u_` | info/ 更新 | 永久，用户主动维护 | 仅由 info/ 更新 | 5 个以内 |
| **内置技能** | 自由 | 系统 | 永久 | 手动更新 | 无 |

## 生命周期流转

```
┌─────────────────────────────────────────────────────────────────┐
│                         新任务开始                              │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             ▼
                    ┌─────────────────┐
                    │  skill-generator │
                    │  分析任务需求    │
                    └────────┬────────┘
                             │
            ┌────────────────┼────────────────┐
            │                │                │
            ▼                ▼                ▼
     ┌─────────────┐  ┌─────────────┐  ┌─────────────┐
     │  检查 p_    │  │  检查 u_    │  │  生成 k_    │
     │  (复用?)    │  │  (复用?)    │  │  (新技能)   │
     └──────┬──────┘  └──────┬──────┘  └──────┬──────┘
            │                │                │
     ┌──────┴──────┐  ┌──────┴──────┐  ┌──────┴──────┐
     │ 找到: 复用   │  │ 找到: 复用   │  │ 创建临时技能 │
     │ 增加 usage  │  │ 增加 usage  │  │              │
     └─────────────┘  └─────────────┘  └──────┬──────┘
                                            │
                                            ▼
                                     ┌─────────────┐
                                     │  执行 k_    │
                                     │  技能任务   │
                                     └──────┬──────┘
                                            │
                                    ┌───────┴───────┐
                                    │               │
                                    ▼               ▼
                             ┌─────────────┐  ┌─────────────┐
                             │  执行成功   │  │  执行失败   │
                             └──────┬──────┘  └─────────────┘
                                    │
                                    ▼
                             ┌─────────────┐
                             │  询问升级   │
                             │  k_ → p_?  │
                             └──────┬──────┘
                                    │
                           ┌────────┴────────┐
                           │                 │
                           ▼                 ▼
                    ┌─────────────┐  ┌─────────────┐
                    │  是: 升级   │  │  否: 丢弃   │
                    │  k_ → p_    │  │  k_ 技能    │
                    └─────────────┘  └─────────────┘
```

## 升级条件

k_ 技能升级为 p_ 技能的条件：

| 条件 | 说明 |
|-----|------|
| 执行成功 | 技能任务必须成功完成 |
| 可复用性 | 技能内容可应用于其他类似任务 |
| 用户确认 | 用户主动选择升级 |

## 技能命名规范

### k_ 技能（任务技能）

```
k[任务ID]_[action]_[target]

示例:
- k01_init_project        # 初始化项目
- k01_config_mdx          # 配置 MDX
- k01_create_layout       # 创建布局
- k01_fix_routing         # 修复路由
- k02_design_schema       # 设计数据库
```

### p_ 技能（验证技能）

```
p_[domain]_[action]

示例:
- p_research_open_source     # 开源项目调研
- p_article_techar          # 技术文章撰写
- p_next_mdx               # Next.js + MDX 博客
- p_docker_deploy          # Docker 部署
- p_fastapi_crud           # FastAPI CRUD
```

### u_ 技能（用户技能）

```
u_[project|technology|tool]

示例:
- u_blog_mdx              # MDX 博客经验
- u_react_hooks           # React Hooks 经验
- u_docker_compose        # Docker Compose 经验
```

## 技能对比

| 维度 | k_ 技能 | p_ 技能 | u_ 技能 |
|-----|--------|--------|--------|
| **来源** | 任务生成 | k_ 升级 | info/ 提取 |
| **验证** | 未验证 | 已验证 | 用户声称 |
| **更新** | 不可更新 | usage_count | 仅 info/ 更新 |
| **归档** | 任务完成后 | 不归档 | 超限时归档 |
| **复用** | 不复用 | 高优先级 | 中优先级 |
| **数量** | 2-3个/任务 | **10 个** | 5个以内 |

## 数据结构

```json
{
  "proven_skills": {
    "p_research_open_source": {
      "source": "k01_research",
      "derived_at": "2026-01-31T00:00:00Z",
      "usage_count": 3,
      "related_tasks": ["k01", "k05", "k08"],
      "success_rate": 1.0
    }
  },
  "user_skills": {
    "u_markdown_illustrator": {
      "name": "Markdown 文章自动配图系统",
      "level": "proficient",
      "created_at": "2026-01-30T00:00:00Z",
      "usage_count": 0
    }
  }
}
```
