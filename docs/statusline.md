# Statusline çŠ¶æ€æ 

è‡ªå®šä¹‰ Claude Code çŠ¶æ€æ ï¼Œå®æ—¶æ˜¾ç¤ºä¼šè¯å…³é”®ä¿¡æ¯ã€‚

## åŠŸèƒ½å±•ç¤º

```
[Claude] ğŸ’ 45% (1.2M) ğŸ“Š 23% â³ 5m30s | ğŸ“‹ k01 æ­å»ºåšå®¢ [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘] 3/4 | ğŸ‘¤ QY | ğŸ”§ 5æŠ€èƒ½(9æ¬¡)
```

| æŒ‡æ ‡ | è¯´æ˜ |
|------|------|
| `[Claude]` | å½“å‰ä½¿ç”¨çš„æ¨¡å‹ |
| ğŸ’ GLM é…é¢ | API é…é¢ä½¿ç”¨ç™¾åˆ†æ¯”å’Œå‰©ä½™é‡ï¼ˆå¸¦ 5 åˆ†é’Ÿç¼“å­˜ï¼‰ |
| ğŸ“Š ä¸Šä¸‹æ–‡ | å½“å‰ä¼šè¯ä¸Šä¸‹æ–‡ä½¿ç”¨ç‡ |
| â³ ä¼šè¯æ—¶é—´ | ä¼šè¯æŒç»­æ—¶é•¿ |
| â†‘â†“ Token | è¾“å…¥/è¾“å‡º token æ•°é‡ |
| ğŸ“‹ ä»»åŠ¡è¿›åº¦ | å½“å‰æ´»è·ƒä»»åŠ¡çš„è¿›åº¦æ¡ |
| ğŸ‘¤ ç”¨æˆ·ç”»åƒ | ç”¨æˆ·åç§°å’Œç”»åƒæ–°é²œåº¦è­¦å‘Š |
| ğŸ”§ æŠ€èƒ½ç»Ÿè®¡ | æŠ€èƒ½æ•°é‡å’Œä½¿ç”¨æ¬¡æ•°ï¼ˆé€šè¿‡è§£æä¼šè¯å†å²ç»Ÿè®¡ï¼‰ |

## é¢œè‰²å«ä¹‰

| é¢œè‰² | å«ä¹‰ |
|------|------|
| ğŸŸ¢ ç»¿è‰² | ä½¿ç”¨ç‡ < 50% |
| ğŸŸ¡ é»„è‰² | ä½¿ç”¨ç‡ 50% - 80% |
| ğŸ”´ çº¢è‰² | ä½¿ç”¨ç‡ > 80% |

## é…ç½®

é…ç½®æ–‡ä»¶ï¼š`.claude/settings.json`

```json
{
  "statusLine": {
    "type": "command",
    "command": "\"$CLAUDE_PROJECT_DIR\"/.claude/statusline.sh"
  }
}
```

## ç¯å¢ƒå˜é‡

| å˜é‡ | è¯´æ˜ |
|------|------|
| `ANTHROPIC_AUTH_TOKEN` | API è®¤è¯ä»¤ç‰Œï¼ˆç”¨äºè·å– GLM é…é¢ï¼‰ |
| `ANTHROPIC_BASE_URL` | API åŸºç¡€ URLï¼ˆç”¨äºè·å– GLM é…é¢ï¼‰ |

## çŠ¶æ€æ–‡ä»¶

- **ä½ç½®**ï¼š`.info/.status.json`
- **ç”¨é€”**ï¼šå­˜å‚¨ä»»åŠ¡ã€ç”¨æˆ·ã€æŠ€èƒ½çŠ¶æ€
- **æ›´æ–°**ï¼šç”± PostToolUse hook è‡ªåŠ¨æ›´æ–°

## æŠ€èƒ½ä½¿ç”¨ç»Ÿè®¡

çŠ¶æ€æ é€šè¿‡è§£æä¼šè¯å†å²æ–‡ä»¶æ¥ç»Ÿè®¡æŠ€èƒ½ä½¿ç”¨æ¬¡æ•°ï¼š

### æ•°æ®æ¥æº

1. **é¡¹ç›®ä¼šè¯æ–‡ä»¶**ï¼š`~/.claude/projects/-workspaces-Skills-demo/<sessionId>.jsonl`
2. **å…¨å±€å†å²æ–‡ä»¶**ï¼š`~/.claude/history.jsonl`

### ç»Ÿè®¡æ–¹æ³•

- ä»ä¼šè¯æ–‡ä»¶ä¸­æå– `type == "tool_use"` ä¸” `name` ä»¥ `/` å¼€å¤´çš„è®°å½•
- ç»Ÿè®¡ç»“æœç¼“å­˜åœ¨ `.info/skills_usage_cache.json`ï¼ˆ5 åˆ†é’Ÿæœ‰æ•ˆæœŸï¼‰

### ç¼“å­˜æ–‡ä»¶ç»“æ„

```json
{
  "/init": 2,
  "/mcp": 3,
  "/skills": 1,
  "total_usage": 9
}
```

### å®ç°è„šæœ¬

- **ç»Ÿè®¡è„šæœ¬**ï¼š`.claude/hooks/count-skills-usage.sh`
- **ç¼“å­˜ä½ç½®**ï¼š`.info/skills_usage_cache.json`

## GLM é…é¢è·å–

çŠ¶æ€æ ä¼šä» API è·å–é…é¢ä¿¡æ¯ï¼š
- **ç«¯ç‚¹**ï¼š`/api/monitor/usage/quota/limit`
- **ç¼“å­˜**ï¼š5 åˆ†é’Ÿï¼Œå­˜å‚¨åœ¨ `~/.claude/glm_quota_cache.txt`
- **å¤±æ•ˆ**ï¼šå¦‚æœæœªé…ç½® `ANTHROPIC_AUTH_TOKEN` æˆ– `ANTHROPIC_BASE_URL`ï¼Œåˆ™ä¸æ˜¾ç¤ºé…é¢ä¿¡æ¯

## å®ç°æ–‡ä»¶

- **ä¸»è„šæœ¬**ï¼š`.claude/statusline.sh`
- **ç»Ÿè®¡è„šæœ¬**ï¼š`.claude/hooks/count-skills-usage.sh`
- **çŠ¶æ€æ›´æ–° Hook**ï¼š`.claude/hooks/update-status.sh`
- **é…ç½®**ï¼š`.claude/settings.json`

## è‡ªå®šä¹‰

å¦‚éœ€è‡ªå®šä¹‰æ˜¾ç¤ºå†…å®¹ï¼Œç¼–è¾‘ `.claude/statusline.sh` è„šæœ¬ä¸­çš„ç›¸å…³å‡½æ•°ï¼š
- `get_glm_quota()` - GLM é…é¢
- `get_context_usage()` - ä¸Šä¸‹æ–‡ä½¿ç”¨ç‡
- `get_session_duration()` - ä¼šè¯æ—¶é•¿
- `get_token_stats()` - Token ç»Ÿè®¡
- `get_system_status()` - ç³»ç»ŸçŠ¶æ€
