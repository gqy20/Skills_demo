# Statusline çŠ¶æ€æ 

è‡ªå®šä¹‰ Claude Code çŠ¶æ€æ ï¼Œå®æ—¶æ˜¾ç¤ºä¼šè¯å…³é”®ä¿¡æ¯ã€‚

## åŠŸèƒ½å±•ç¤º

```
[Claude] ğŸ’ 45% (1.2M) ğŸ“Š 23% â³ 5m30s | ğŸ“‹ k01 æ­å»ºåšå®¢ [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘] 3/4 | ğŸ‘¤ QY | ğŸ”§ 5æŠ€èƒ½(9æ¬¡)
```

| æŒ‡æ ‡ | è¯´æ˜ |
|------|------|
| `[Claude]` | å½“å‰ä½¿ç”¨çš„æ¨¡å‹ |
| ğŸ’ GLM é…é¢ | API é…é¢ä½¿ç”¨ç™¾åˆ†æ¯”å’Œå‰©ä½™é‡ï¼ˆå¸¦ 5 åˆ†é’Ÿç¼“å­˜ï¼‰ |
| ğŸ“Š ä¸Šä¸‹æ–‡ | å½“å‰ä¼šè¯ä¸Šä¸‹æ–‡ä½¿ç”¨ç‡ |
| â³ ä¼šè¯æ—¶é—´ | ä¼šè¯æŒç»­æ—¶é•¿ |
| â†‘â†“ Token | è¾“å…¥/è¾“å‡º token æ•°é‡ |
| ğŸ“‹ ä»»åŠ¡è¿›åº¦ | å½“å‰æ´»è·ƒä»»åŠ¡çš„è¿›åº¦æ¡ |
| ğŸ‘¤ ç”¨æˆ·ç”»åƒ | ç”¨æˆ·åç§°å’Œç”»åƒæ–°é²œåº¦è­¦å‘Š |
| ğŸ”§ æŠ€èƒ½ç»Ÿè®¡ | æŠ€èƒ½æ•°é‡å’Œä½¿ç”¨æ¬¡æ•°ï¼ˆé€šè¿‡è§£æä¼šè¯å†å²ç»Ÿè®¡ï¼‰ |

## é¢œè‰²å«ä¹‰

| é¢œè‰² | å«ä¹‰ |
|------|------|
| ğŸŸ¢ ç»¿è‰² | ä½¿ç”¨ç‡ < 50% |
| ğŸŸ¡ é»„è‰² | ä½¿ç”¨ç‡ 50% - 80% |
| ğŸ”´ çº¢è‰² | ä½¿ç”¨ç‡ > 80% |

## é…ç½®

é…ç½®æ–‡ä»¶ï¼š`.claude/settings.json`

```json
{
  "statusLine": {
    "type": "command",
    "command": "\"$CLAUDE_PROJECT_DIR\"/.claude/statusline.sh"
  }
}
```

## ç¯å¢ƒå˜é‡

| å˜é‡ | è¯´æ˜ |
|------|------|
| `ANTHROPIC_AUTH_TOKEN` | API è®¤è¯ä»¤ç‰Œï¼ˆç”¨äºè·å– GLM é…é¢ï¼‰ |
| `ANTHROPIC_BASE_URL` | API åŸºç¡€ URLï¼ˆç”¨äºè·å– GLM é…é¢ï¼‰ |

## çŠ¶æ€æ–‡ä»¶

- **ä½ç½®**ï¼š`.info/.status.json`
- **ç”¨é€”**ï¼šå­˜å‚¨ä»»åŠ¡ã€ç”¨æˆ·ã€æŠ€èƒ½çŠ¶æ€
- **æ›´æ–°**ï¼šç”± PostToolUse hook è‡ªåŠ¨æ›´æ–°

## æŠ€èƒ½ä½¿ç”¨ç»Ÿè®¡

çŠ¶æ€æ ä» `.info/.status.json` è¯»å–æŠ€èƒ½ç»Ÿè®¡æ•°æ®ã€‚

### æ•°æ®æ¥æº

- **çŠ¶æ€æ–‡ä»¶**ï¼š`.info/.status.json`
- **æ›´æ–°æ–¹å¼**ï¼šç”± `update-status.sh` Hook è‡ªåŠ¨ç»´æŠ¤

### ç»Ÿè®¡å†…å®¹

| å­—æ®µ | è¯´æ˜ |
|------|------|
| `skills_count` | æ€»æŠ€èƒ½æ•°ï¼ˆå†…ç½® + u_ + p_ + k_ï¼‰ |
| `proven_skills_count` | p_ æŠ€èƒ½æ•°é‡ |
| `total_reuses` | p_ æŠ€èƒ½å¤ç”¨æ€»æ¬¡æ•° |
| `top_reused_skill` | å¤ç”¨æ¬¡æ•°æœ€å¤šçš„æŠ€èƒ½ |
| `top_reuse_count` | æœ€é«˜å¤ç”¨æ¬¡æ•° |
| `active_proven_skills` | æœ‰ä½¿ç”¨è®°å½•çš„ p_ æŠ€èƒ½æ•° |

### çŠ¶æ€æ–‡ä»¶ç¤ºä¾‹

```json
{
  "skills_count": 9,
  "proven_skills_count": 2,
  "total_reuses": 12,
  "top_reused_skill": "p_mdx_setup",
  "top_reuse_count": 5,
  "active_proven_skills": 2
}
```

## GLM é…é¢è·å–

çŠ¶æ€æ ä¼šä» API è·å–é…é¢ä¿¡æ¯ï¼š
- **ç«¯ç‚¹**ï¼š`/api/monitor/usage/quota/limit`
- **ç¼“å­˜**ï¼š5 åˆ†é’Ÿï¼Œå­˜å‚¨åœ¨ `~/.claude/glm_quota_cache.txt`
- **å¤±æ•ˆ**ï¼šå¦‚æœæœªé…ç½® `ANTHROPIC_AUTH_TOKEN` æˆ– `ANTHROPIC_BASE_URL`ï¼Œåˆ™ä¸æ˜¾ç¤ºé…é¢ä¿¡æ¯

## å®ç°æ–‡ä»¶

- **ä¸»è„šæœ¬**ï¼š`.claude/statusline.sh`
- **å…±äº«åº“**ï¼š`.claude/hooks/lib/common.sh`ï¼ˆæŠ€èƒ½ç»Ÿè®¡å‡½æ•°ï¼‰
- **çŠ¶æ€æ›´æ–° Hook**ï¼š`.claude/hooks/update-status.sh`
- **é…ç½®**ï¼š`.claude/settings.json`

## è‡ªå®šä¹‰

å¦‚éœ€è‡ªå®šä¹‰æ˜¾ç¤ºå†…å®¹ï¼Œç¼–è¾‘ `.claude/statusline.sh` è„šæœ¬ä¸­çš„ç›¸å…³å‡½æ•°ï¼š
- `get_glm_quota()` - GLM é…é¢
- `get_context_usage()` - ä¸Šä¸‹æ–‡ä½¿ç”¨ç‡
- `get_session_duration()` - ä¼šè¯æ—¶é•¿
- `get_token_stats()` - Token ç»Ÿè®¡
- `get_system_status()` - ç³»ç»ŸçŠ¶æ€
